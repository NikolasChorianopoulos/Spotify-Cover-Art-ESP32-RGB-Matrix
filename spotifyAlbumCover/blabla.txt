#include <Arduino.h>
#include <WiFi.h>
#include <HTTPClient.h>
#include <TJpg_Decoder.h>
#include <ESP32-HUB75-MatrixPanel-I2S-DMA.h>
#include <ArduinoJson.h>
#include "FS.h"
#include <LittleFS.h>
#include <Wire.h>
#include <SPI.h>
#include "SPIFFS.h"
#include <SD.h>


/* WiFi Credentials
const char* ssid = "Crazy Science Duck";
const char* password = "6986821238";
*/


// Spotify credentials
const char* client_id = "e57a0662b41a486ea2cdcfe94f457876";
const char* client_secret = "c8feb5189c2747eaa1327d74c8a9bf2c";
String refresh_token = "AQCBcHxTke_q-vYyvjTtu3Wwsu2hlr9GMvK1ueyqtnrLPnYXxBGAn3iIP6_4779ws65y_ehRtB_yjBaRiN4P3G27TizdD-4lHRKNY2y2HZQm6FZejR67RXPVc4blSxpc6zg"; // Obtain this from initial authorization
String access_token;

// Spotify API URLs
const char* token_url = "https://accounts.spotify.com/api/token";
const char* currently_playing_url = "https://api.spotify.com/v1/me/player/currently-playing";







MatrixPanel_I2S_DMA matrix;

void displaySetup() {
  // Matrix Panel Object
  HUB75_I2S_CFG mxconfig(
    64, // Width
    64, // Height
    1  // Number of chained panels
  );

    mxconfig.clkphase = false;

    //Pin Configuration, Initialize Matrix, Text Settings
    mxconfig.gpio.r1 = 25;
    mxconfig.gpio.g1 = 26;
    mxconfig.gpio.b1 = 27;
    mxconfig.gpio.r2 = 14;
    mxconfig.gpio.g2 = 12;
    mxconfig.gpio.b2 = 13;
    mxconfig.gpio.a = 23;
    mxconfig.gpio.b = 19;
    mxconfig.gpio.c = 5;
    mxconfig.gpio.d = 17;
    mxconfig.gpio.e = 32;
    mxconfig.gpio.lat = 4;
    mxconfig.gpio.oe = 15;
    mxconfig.gpio.clk = 16;
  
    
    matrix.begin(mxconfig);
    matrix.fillScreen(matrix.color565(0, 0, 0));
    matrix.setBrightness(150);
    

}

void noSongPlaying(){

  matrix.fillScreen(matrix.color565(250, 250, 250));
  uint16_t borderColor = matrix.color565(0, 0, 0);
  matrix.drawRect(2, 2, 60, 60, borderColor); //(x, y ,h ,w color)

  matrix.setCursor(11, 20);
  matrix.setTextColor(matrix.color565(0, 0, 0));
  matrix.setTextSize(1);
  matrix.print("No Song"); 
  matrix.setCursor(11, 31); 
  matrix.print("Playing");
}





void setup() {
  Serial.begin(115200);

  Serial.println("Starting...");

  displaySetup();

  noSongPlaying();

  /* Connect to WiFi
  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println("WiFi connected.");
*/
  


 
}

void loop() {
   
}
